# Авторизация

## Объекты
Объект с логином и паролем:
```json
{
    "login": "login",
    "password": "password"
}
```
Объект с токеном
```json lines
{
  "token": "token"
}
```

## Предисловие
Если вы хешируете пароли на серверной части, **НЕ НУЖНО ИХ ХЕШИРОВАТЬ ПРИ ПЕРЕДАЧЕ К СЕРВЕРУ, КЛИЕНТ ПЕРЕДАЕТ ПАРОЛЬ В СЫРОМ ВИДЕ И МОЛИТЬСЯ ЧТО TLS ЕГО СПАСЕТ :trollface:**

## Серверная часть
Реализуем эндпоинт `/auth`, который принимает JSON с логином и паролем. Проверяем, есть ли такой пользователь в базе данных. Если есть, то генерируем токен и сохраняем его в базу данных. Возвращаем токен клиенту.<br>
Ответ: Объект с токеном и статусом 200 OK
**Токен нужно сохранять в базе данных для WebSocket авторизации, при этом токенов может быть много**

Если логин или пароль не верный, то возвращаем ошибку 401 Unauthorized
```json lines
{
  "error": "Unauthorized"
}
```
## Клиентская часть
Делаем запрос на `https://example.com/auth` с объектом с логином и паролем.
Если все успешно получим JSON объект с токеном, если нет, то получим ошибку 401 Unauthorized
```json lines
{
  "error": "Unauthorized"
}
```

# Регистрация
## Серверная часть
Реализуем эндпоинт `/register`, который принимает JSON с логином и паролем. Проверяем, есть ли такой пользователь в базе данных. Если есть, то возвращаем ошибку 409 Conflict
```json lines
{
  "error": "Conflict"
}
```
Если пользователя нет, то добавляем его в базу данных и возвращаем 200 OK
```json lines
{
  "success": true
}
```
Пароль можете хешировать, можете нет, на ваше усмотрение.

## Клиентская часть
Делаем запрос на `https://example.com/register` с объектом с логином и паролем. Если все хорошо, то возвращается 200 OK
```json lines
{
  "success": true
}
```
# Восстановление пароля
Только через владельца сервера. Сами ему доказывайте что вы владелец аккаунта и прочее. Возможно ваш провайдер MCP реализует функцию для восстановления аккаунта без мороки с базой данных. Один совет для владельцев: Ревокайте (сбрасывайте) все токены при восстановлении пароля.